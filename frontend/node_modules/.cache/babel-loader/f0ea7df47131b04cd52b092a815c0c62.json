{"ast":null,"code":"var _jsxFileName = \"/Users/jielianglin/Desktop/m-v2-frontend/frontend/src/components/upload/annotation/P5Mask.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport axios from \"axios\";\nimport FileInput from '../FileInput';\nimport Tags from './Tags';\nimport Caption from './Caption';\nimport Sketch from 'react-p5';\nimport ColorSelector from './ColorSelector';\nimport EraserIcon from './eraser/EraserIcon.png';\nimport CheckMark from './checkmark/CheckMark.png';\nimport { Typography, Chip, Avatar } from \"@material-ui/core\";\nimport Button from \"@material-ui/core/Button\";\nimport VisibilitySharpIcon from '@material-ui/icons/VisibilitySharp';\nimport VisibilityOffIcon from '@material-ui/icons/VisibilityOff';\nimport { ThemeProvider } from \"@material-ui/styles\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { createTheme } from \"@material-ui/core/styles\";\nimport MatchBar from \"../../explore/Matchbar\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar slider;\nvar checkButton;\nvar clearButton;\nvar cnv;\nvar diameter = 50;\nvar smoothValue = 0.05;\nlet img;\nlet pg;\nvar x = 0;\nvar y = 0;\nvar imgWidth;\nvar imgHeight;\nconst theme = createTheme({\n  palette: {\n    primary: {\n      main: \"#B272CE\"\n    }\n  }\n});\nexport default function Mask() {\n  _s();\n\n  const [color, setColor] = React.useState(['#B272CE']);\n  const [canvasImage, setCanvasImage] = React.useState(null);\n  const [post, setPost] = React.useState(false);\n  const [tags, setTags] = React.useState([]);\n  const [src, setSrc] = React.useState(null);\n  const [caption, setCaption] = React.useState(null);\n  const [returnCaption, setReturnCaption] = React.useState(null);\n  const [returnTags, setReturnTags] = React.useState([]);\n  const [returnAITags, setReturnAITags] = React.useState([]);\n  const [returnShape, setReturnShape] = React.useState([]);\n  const [shapeVisibility, setShapeVisibility] = React.useState(false);\n  const [progress, setProgress] = React.useState(false);\n\n  const enteredCaption = caption => {\n    setCaption(caption);\n  };\n\n  const selectedTags = tags => {\n    setTags(tags);\n  };\n\n  const resetCanvas = () => {\n    setCanvasImage(!canvasImage);\n  };\n\n  function setup(p5, canvasParentRef) {\n    cnv = p5.createCanvas(600, 600).parent(canvasParentRef);\n    img = p5.loadImage(canvasImage, img => {\n      p5.image(img, 0, 0);\n    });\n    pg = p5.createGraphics(600, 600);\n    checkButton = p5.createImg(`${CheckMark}`).style('margin: 10px; width: 50px; height: 50px');\n    checkButton.position(100, 200);\n    checkButton.mousePressed(setFiles);\n    clearButton = p5.createImg(`${EraserIcon}`).style('margin: 10px; width: 50px; height: 50px');\n    clearButton.position(100, 300);\n    clearButton.mousePressed(resetSketch);\n    slider = p5.createSlider(10, 100, 50, 10);\n    slider.position(1175, 600);\n    slider.style('width', '80px');\n    slider.mousePressed(getDiameter);\n  }\n\n  function getDiameter(p5) {\n    diameter = slider.value();\n    return diameter;\n  }\n\n  const draw = p5 => {\n    if (color) {\n      x = p5.lerp(p5.pmouseX, p5.mouseX, smoothValue);\n      y = p5.lerp(p5.pmouseY, p5.mouseY, smoothValue);\n      imgWidth = img.width;\n      imgHeight = img.height;\n\n      if (imgWidth > 0 && imgHeight > 0) {\n        p5.resizeCanvas(imgWidth, imgHeight);\n\n        if (imgWidth > 800) {\n          p5.resizeCanvas(700, imgHeight);\n        }\n      }\n\n      p5.image(img, 0, 0);\n      var transparency = p5.color(color);\n      transparency.setAlpha(7);\n      pg.noStroke();\n      pg.fill(transparency);\n\n      if (p5.mouseIsPressed) {\n        pg.ellipse(x, y, diameter, diameter);\n      }\n\n      p5.image(pg, 0, 0, imgWidth, imgHeight);\n    } else {\n      return null;\n    }\n  };\n\n  function resetSketch(p5) {\n    pg.clear();\n  } //preparing files for p5 post\n\n\n  function setFiles(p5) {\n    let image = cnv.elt.toDataURL();\n    let shape = pg.elt.toDataURL();\n    return {\n      image,\n      shape\n    };\n  }\n\n  let APIurl = \"http://localhost:8000/images\"; //p5 post function\n  // function P5PostRequest(p5) {\n  //   p5.httpPost(APIurl, 'json', P5PostData,\n  //     function (result) {\n  //       console.log(\"postedCanvas\")\n  //     });\n  // }\n  // main post function\n\n  async function postData(p5) {\n    let {\n      image,\n      shape\n    } = setFiles(p5);\n    let formData = new FormData();\n    console.log(tags.join(\",\"));\n    formData.append(\"tags\", tags.join(\",\"));\n    formData.append(\"caption\", caption);\n    formData.append(\"files\", [image, shape]);\n    let response = {};\n\n    try {\n      response = await axios.post(APIurl, formData);\n    } catch (e) {\n      console.error(e);\n      return;\n    }\n\n    setSrc(`http://localhost:8000/images/${response.data.id}.jpeg`);\n    console.log(response.data.caption);\n    setReturnCaption(response.data.caption);\n    console.log(response.data.tags);\n    setReturnTags(response.data.tags);\n    console.log(response.data.ai_tags);\n    setReturnAITags(response.data.ai_tags || []);\n    setReturnShape(`http://localhost:8000/images/${response.data.shape}.png`);\n    setPost(true);\n    setProgress(false);\n  }\n\n  const showShape = () => {\n    setShapeVisibility(!shapeVisibility);\n  };\n\n  if (canvasImage) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          backgroundColor: \"#FFFFFF\",\n          borderRadius: \"3px\",\n          boxShadow: \"3px 3px 3px #b4beb7\",\n          padding: \"50px\",\n          maxWidth: \"800px\",\n          height: \"auto\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(Caption, {\n          enteredCaption: enteredCaption\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Sketch, {\n            setup: setup,\n            draw: draw\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Tags, {\n          selectedTags: selectedTags\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(ColorSelector, {\n        selectColor: color => setColor(color)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"save-data\",\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          disabled: !canvasImage || !caption || tags.length === 0,\n          className: \"save-button\",\n          palette: \"primary\",\n          onClick: postData,\n          children: [\" \", \"Save\", \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(ThemeProvider, {\n          theme: theme,\n          children: progress && /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 17\n      }, this), post ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"returnForm\",\n        style: {\n          backgroundColor: \"#FFFFFF\",\n          borderRadius: \"3px\",\n          boxShadow: \"3px 3px 3px #b4beb7\",\n          padding: \"50px\",\n          maxWidth: \"800px\",\n          height: \"auto\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          style: {\n            display: \"block\",\n            margin: \"0 auto\",\n            height: \"50%\",\n            borderRadius: \"5px\",\n            zIndex: 1\n          },\n          className: \"returned-image\",\n          src: src,\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 29\n        }, this), shapeVisibility && /*#__PURE__*/_jsxDEV(\"img\", {\n          style: {\n            display: \"block\",\n            margin: \"0 auto\",\n            height: \"50%\",\n            borderRadius: \"5px\",\n            zIndex: 2\n          },\n          className: \"returned-shape\",\n          src: returnShape,\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 33\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: showShape,\n          children: shapeVisibility ? /*#__PURE__*/_jsxDEV(VisibilityOffIcon, {\n            fontsize: \"medium\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 52\n          }, this) : /*#__PURE__*/_jsxDEV(VisibilitySharpIcon, {\n            fontsize: \"medium\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 94\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(ThemeProvider, {\n          theme: theme,\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"h6\",\n            color: \"primary\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"returned-caption\",\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                children: \"\\\"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 265,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"i\", {\n                children: [\" \", /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: returnCaption\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 268,\n                  columnNumber: 45\n                }, this), \" \"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 266,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"i\", {\n                children: \"\\\"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 270,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tags-return\",\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              color: \"primary\",\n              children: \" Your Tags: \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 275,\n              columnNumber: 37\n            }, this), returnTags.map(item => /*#__PURE__*/_jsxDEV(Chip, {\n              className: \"chip1\",\n              style: {\n                color: \"#B272CE\",\n                backgroundColor: \"#FFFFFF\"\n              },\n              avatar: /*#__PURE__*/_jsxDEV(Avatar, {\n                style: {\n                  color: \"#B272CE\"\n                },\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    color: \"#FFFFFF\"\n                  },\n                  children: \"#\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 279,\n                  columnNumber: 49\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 278,\n                columnNumber: 45\n              }, this),\n              label: item.tag,\n              variant: \"outlined\"\n            }, item.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 41\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"ai_tags_return\",\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              color: \"secondary\",\n              children: \" Tags from ImageNet AI: \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 293,\n              columnNumber: 37\n            }, this), returnAITags.length === 0 && /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"h12\",\n              color: \"#000000\",\n              children: /*#__PURE__*/_jsxDEV(\"i\", {\n                children: \"[couldn't identify any tags] \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 296,\n                columnNumber: 45\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: returnAITags.map(item => /*#__PURE__*/_jsxDEV(Chip, {\n                className: \"chip2\",\n                style: {\n                  color: \"#000000\",\n                  backgroundColor: \"#FFFFFF\"\n                },\n                avatar: /*#__PURE__*/_jsxDEV(Avatar, {\n                  style: {\n                    background: \"#B5BCB4\"\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      color: \"#FFFFFF\"\n                    },\n                    children: \"#\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 304,\n                    columnNumber: 57\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 303,\n                  columnNumber: 53\n                }, this),\n                label: item.tag\n              }, item.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 301,\n                columnNumber: 45\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 299,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: returnAITags.map(aiitem => {\n                return /*#__PURE__*/_jsxDEV(MatchBar, {\n                  match: parseFloat(aiitem.confidence),\n                  aitag: aiitem.tag\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 317,\n                  columnNumber: 49\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 314,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            onClick: resetCanvas,\n            children: \"Back to WellBeing upload\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 327,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 25\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 13\n    }, this);\n  } else {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(FileInput, {\n        selectImage: setCanvasImage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 13\n    }, this);\n  }\n}\n\n_s(Mask, \"sv+UfCnSdYl/5WaFGvcXio5DAyI=\");\n\n_c = Mask;\n\nvar _c;\n\n$RefreshReg$(_c, \"Mask\");","map":{"version":3,"sources":["/Users/jielianglin/Desktop/m-v2-frontend/frontend/src/components/upload/annotation/P5Mask.js"],"names":["React","axios","FileInput","Tags","Caption","Sketch","ColorSelector","EraserIcon","CheckMark","Typography","Chip","Avatar","Button","VisibilitySharpIcon","VisibilityOffIcon","ThemeProvider","CircularProgress","createTheme","MatchBar","slider","checkButton","clearButton","cnv","diameter","smoothValue","img","pg","x","y","imgWidth","imgHeight","theme","palette","primary","main","Mask","color","setColor","useState","canvasImage","setCanvasImage","post","setPost","tags","setTags","src","setSrc","caption","setCaption","returnCaption","setReturnCaption","returnTags","setReturnTags","returnAITags","setReturnAITags","returnShape","setReturnShape","shapeVisibility","setShapeVisibility","progress","setProgress","enteredCaption","selectedTags","resetCanvas","setup","p5","canvasParentRef","createCanvas","parent","loadImage","image","createGraphics","createImg","style","position","mousePressed","setFiles","resetSketch","createSlider","getDiameter","value","draw","lerp","pmouseX","mouseX","pmouseY","mouseY","width","height","resizeCanvas","transparency","setAlpha","noStroke","fill","mouseIsPressed","ellipse","clear","elt","toDataURL","shape","APIurl","postData","formData","FormData","console","log","join","append","response","e","error","data","id","ai_tags","showShape","backgroundColor","borderRadius","boxShadow","padding","maxWidth","length","display","margin","zIndex","map","item","tag","background","aiitem","parseFloat","confidence"],"mappings":"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","sourcesContent":["import React from 'react';\nimport axios from \"axios\";\n\nimport FileInput from '../FileInput';\nimport Tags from './Tags';\nimport Caption from './Caption';\n\nimport Sketch from 'react-p5';\nimport ColorSelector from './ColorSelector';\n\nimport EraserIcon from './eraser/EraserIcon.png';\nimport CheckMark from './checkmark/CheckMark.png';\n\nimport { Typography, Chip, Avatar } from \"@material-ui/core\";\nimport Button from \"@material-ui/core/Button\";\nimport VisibilitySharpIcon from '@material-ui/icons/VisibilitySharp';\nimport VisibilityOffIcon from '@material-ui/icons/VisibilityOff';\n\n\nimport { ThemeProvider } from \"@material-ui/styles\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { createTheme } from \"@material-ui/core/styles\";\n\nimport MatchBar from \"../../explore/Matchbar\";\n\nvar slider;\nvar checkButton;\nvar clearButton;\nvar cnv;\n\nvar diameter = 50;\nvar smoothValue = 0.05;\nlet img;\nlet pg;\n\nvar x = 0;\nvar y = 0;\nvar imgWidth;\nvar imgHeight;\n\nconst theme = createTheme({\n    palette: {\n        primary: {\n            main: \"#B272CE\",\n        },\n    },\n});\n\nexport default function Mask() {\n\n    const [color, setColor] = React.useState(['#B272CE']);\n    const [canvasImage, setCanvasImage] = React.useState(null);\n\n    const [post, setPost] = React.useState(false);\n    const [tags, setTags] = React.useState([]);\n    const [src, setSrc] = React.useState(null);\n    const [caption, setCaption] = React.useState(null);\n    const [returnCaption, setReturnCaption] = React.useState(null);\n    const [returnTags, setReturnTags] = React.useState([])\n    const [returnAITags, setReturnAITags] = React.useState([]);\n    const [returnShape, setReturnShape] = React.useState([]);\n    const [shapeVisibility, setShapeVisibility] = React.useState(false);\n    const [progress, setProgress] = React.useState(false);\n\n    const enteredCaption = (caption) => {\n        setCaption(caption);\n    };\n    const selectedTags = (tags) => {\n        setTags(tags);\n    };\n\n    const resetCanvas = () => {\n        setCanvasImage(!canvasImage);\n    }\n\n    function setup(p5, canvasParentRef) {\n        cnv = p5.createCanvas(600, 600).parent(canvasParentRef);\n\n        img = p5.loadImage(canvasImage, img => {\n            p5.image(img, 0, 0);\n        });\n\n        pg = p5.createGraphics(600, 600);\n\n        checkButton = p5.createImg(`${CheckMark}`).style(\n            'margin: 10px; width: 50px; height: 50px'\n        )\n\n        checkButton.position(100, 200);\n        checkButton.mousePressed(setFiles);\n\n        clearButton = p5.createImg(`${EraserIcon}`).style(\n            'margin: 10px; width: 50px; height: 50px'\n        )\n        clearButton.position(100, 300);\n        clearButton.mousePressed(resetSketch);\n\n        slider = p5.createSlider(10, 100, 50, 10);\n        slider.position(1175, 600);\n        slider.style('width', '80px');\n        slider.mousePressed(getDiameter);\n    }\n\n    function getDiameter(p5) {\n        diameter = slider.value();\n        return (diameter);\n    }\n\n    const draw = p5 => {\n        if (color) {\n            x = p5.lerp(p5.pmouseX, p5.mouseX, smoothValue);\n            y = p5.lerp(p5.pmouseY, p5.mouseY, smoothValue);\n\n\n            imgWidth = img.width;\n            imgHeight = img.height;\n\n            if (imgWidth > 0 && imgHeight > 0) {\n                p5.resizeCanvas(imgWidth, imgHeight);\n                if (imgWidth > 800) {\n                    p5.resizeCanvas(700, imgHeight);\n                }\n            }\n\n            p5.image(img, 0, 0);\n\n            var transparency = p5.color(color);\n            transparency.setAlpha(7);\n            pg.noStroke();\n            pg.fill(transparency);\n\n            if (p5.mouseIsPressed) {\n                pg.ellipse(x, y, diameter, diameter);\n            }\n\n            p5.image(pg, 0, 0, imgWidth, imgHeight);\n        } else {\n            return null\n        }\n    }\n\n    function resetSketch(p5) {\n        pg.clear();\n    }\n\n    //preparing files for p5 post\n    function setFiles(p5) {\n        let image = cnv.elt.toDataURL();\n        let shape = pg.elt.toDataURL();\n        return { image, shape };\n    }\n\n    let APIurl = \"http://localhost:8000/images\";\n\n    //p5 post function\n    // function P5PostRequest(p5) {\n    //   p5.httpPost(APIurl, 'json', P5PostData,\n    //     function (result) {\n    //       console.log(\"postedCanvas\")\n    //     });\n    // }\n\n    // main post function\n    async function postData(p5) {\n        let { image, shape } = setFiles(p5);\n\n        let formData = new FormData();\n        console.log(tags.join(\",\"));\n        formData.append(\"tags\", tags.join(\",\"));\n        formData.append(\"caption\", caption);\n        formData.append(\"files\", [image, shape]);\n\n        let response = {};\n        try {\n            response = await axios.post(APIurl, formData);\n        } catch (e) {\n            console.error(e);\n            return;\n        }\n\n        setSrc(`http://localhost:8000/images/${response.data.id}.jpeg`);\n        console.log(response.data.caption);\n        setReturnCaption(response.data.caption);\n        console.log(response.data.tags);\n        setReturnTags(response.data.tags);\n        console.log(response.data.ai_tags);\n        setReturnAITags(response.data.ai_tags || []);\n        setReturnShape(`http://localhost:8000/images/${response.data.shape}.png`);\n        setPost(true);\n        setProgress(false);\n    }\n\n    const showShape = () => {\n        setShapeVisibility(!shapeVisibility);\n    }\n\n    if (canvasImage) {\n        return (\n            <div>\n                <br />\n                <div style={{ backgroundColor: \"#FFFFFF\", borderRadius: \"3px\", boxShadow: \"3px 3px 3px #b4beb7\", padding: \"50px\", maxWidth: \"800px\", height: \"auto\" }}>\n                    <Caption enteredCaption={enteredCaption} />\n                    <div>\n                        <br />\n                        <Sketch setup={setup} draw={draw}\n                        />\n                    </div>\n                    <br />\n                    <Tags selectedTags={selectedTags} />\n                </div>\n                <ColorSelector selectColor={color => setColor(color)} />\n                <div className=\"save-data\">\n                    <Button\n                        disabled={!canvasImage || !caption || tags.length === 0}\n                        className=\"save-button\"\n                        palette=\"primary\"\n                        onClick={postData}\n                    >\n                        {\" \"}\n                        Save{\" \"}\n                    </Button>\n                    <ThemeProvider theme={theme}>\n                        {progress &&\n                            <CircularProgress />}\n                    </ThemeProvider>\n                </div>\n                {\n                    post ?\n                        <div className=\"returnForm\" style={{ backgroundColor: \"#FFFFFF\", borderRadius: \"3px\", boxShadow: \"3px 3px 3px #b4beb7\", padding: \"50px\", maxWidth: \"800px\", height: \"auto\" }}>\n                            < img\n                                style={{\n                                    display: \"block\",\n                                    margin: \"0 auto\",\n                                    height: \"50%\",\n                                    borderRadius: \"5px\",\n                                    zIndex: 1,\n                                }}\n                                className=\"returned-image\"\n                                src={src}\n                                alt=\"\"\n                            />\n                            {shapeVisibility &&\n                                <img\n                                    style={{\n                                        display: \"block\",\n                                        margin: \"0 auto\",\n                                        height: \"50%\",\n                                        borderRadius: \"5px\",\n                                        zIndex: 2,\n                                    }}\n                                    className=\"returned-shape\"\n                                    src={returnShape}\n                                    alt=\"\"\n                                />\n                            }\n\n                            <br />\n                            <Button onClick={showShape}>\n                                {shapeVisibility ? <VisibilityOffIcon fontsize=\"medium\" /> : <VisibilitySharpIcon fontsize=\"medium\" />}\n                            </Button>\n                            <br />\n                            <ThemeProvider theme={theme}>\n                                <Typography variant=\"h6\" color=\"primary\">\n                                    <div className=\"returned-caption\">\n                                        <i>\"</i>\n                                        <i>\n                                            {\" \"}\n                                            <span>{returnCaption}</span>{\" \"}\n                                        </i>\n                                        <i>\"</i>\n                                    </div>\n                                </Typography>\n                                <br />\n                                <span className=\"tags-return\">\n                                    <Typography color=\"primary\"> Your Tags: </Typography>\n                                    {returnTags.map((item) => (\n                                        <Chip className=\"chip1\" style={{ color: \"#B272CE\", backgroundColor: \"#FFFFFF\" }} avatar={\n                                            <Avatar style={{ color: \"#B272CE\" }}>\n                                                <div style={{ color: \"#FFFFFF\" }}>\n                                                    #\n                                                </div>\n                                            </Avatar>\n                                        }\n                                            key={item.id}\n                                            label={item.tag}\n                                            variant=\"outlined\"\n                                        />\n                                    ))}\n                                </span>\n                                <br />\n                                <br />\n                                <span className=\"ai_tags_return\">\n                                    <Typography color=\"secondary\"> Tags from ImageNet AI: </Typography>\n                                    {returnAITags.length === 0 && (\n                                        <Typography variant=\"h12\" color=\"#000000\">\n                                            <i>[couldn't identify any tags] </i>\n                                        </Typography>\n                                    )}\n                                    <div>\n                                        {returnAITags.map((item) => (\n                                            <Chip className=\"chip2\" style={{ color: \"#000000\", backgroundColor: \"#FFFFFF\" }}\n                                                avatar={\n                                                    <Avatar style={{ background: \"#B5BCB4\" }}>\n                                                        <div style={{ color: \"#FFFFFF\" }}>\n                                                            #\n                                                        </div>\n                                                    </Avatar>\n                                                }\n                                                key={item.id}\n                                                label={item.tag}\n                                            />\n                                        ))}\n                                    </div>\n                                    <div>\n                                        {returnAITags.map((aiitem) => {\n                                            return (\n                                                <MatchBar\n                                                    match={parseFloat(aiitem.confidence)}\n                                                    aitag={aiitem.tag}\n                                                />\n                                            );\n                                        })}\n                                    </div>\n                                </span>\n                                <br />\n                                <Button onClick={resetCanvas}>Back to WellBeing upload</Button>\n                                <br />\n                            </ThemeProvider>\n                        </div >\n                        : null\n                }\n            </div>)\n    } else {\n        return (\n            <div >\n                <br />\n                <FileInput selectImage={setCanvasImage} />\n            </div>\n        );\n    }\n}\n"]},"metadata":{},"sourceType":"module"}
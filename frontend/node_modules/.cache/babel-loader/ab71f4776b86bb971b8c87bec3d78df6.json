{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jielianglin/Desktop/m-v2-frontend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jielianglin/Desktop/m-v2-frontend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/jielianglin/Desktop/m-v2-frontend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/Users/jielianglin/Desktop/m-v2-frontend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"/Users/jielianglin/Desktop/m-v2-frontend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";var _excluded=[\"children\",\"classes\",\"onClose\"];import React,{useEffect}from\"react\";import ReactEcharts from\"echarts-for-react\";import axios from\"axios\";import Popover from\"@material-ui/core/Popover\";import Dialog from'@material-ui/core/Dialog';import MuiDialogTitle from\"@material-ui/core/DialogTitle\";import MuiDialogContent from\"@material-ui/core/DialogContent\";import{Typography,Chip,Avatar}from\"@material-ui/core\";import IconButton from\"@material-ui/core/IconButton\";import CloseIcon from\"@material-ui/icons/Close\";import{withStyles}from\"@material-ui/core/styles\";import{makeStyles}from'@material-ui/core/styles';import ImageList from'@material-ui/core/ImageList';import ImageListItem from'@material-ui/core/ImageListItem';import Carousel from'react-material-ui-carousel';import MatchBar from\"./Matchbar\";// import Visual from \"./Visual\";\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{popover:{pointerEvents:'none'},paper:{padding:theme.spacing(1),backgroundColor:'transparent'},root:{display:'flex',flexWrap:'wrap',justifyContent:'space-around',overflow:'hidden',backgroundColor:\"#E6DAC8\"},imageList:{width:500,height:450}};});var DialogContent=withStyles(function(theme){return{root:{padding:theme.spacing(2),backgroundColor:\"#E6DAC8\"}};})(MuiDialogContent);var styles=function styles(theme){return{root:{margin:0,padding:theme.spacing(2),color:\"#2B4466\",backgroundColor:\"#E6DAC8\"},closeButton:{position:\"absolute\",right:theme.spacing(1),top:theme.spacing(1),color:theme.palette.grey[500]}};};var DialogTitle=withStyles(styles)(function(props){var children=props.children,classes=props.classes,onClose=props.onClose,other=_objectWithoutProperties(props,_excluded);return/*#__PURE__*/_jsxs(MuiDialogTitle,_objectSpread(_objectSpread({disableTypography:true,className:classes.root},other),{},{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:children}),onClose?/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"close\",className:classes.closeButton,onClick:onClose,children:/*#__PURE__*/_jsx(CloseIcon,{})}):null]}));});export default function Chart(){var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),open=_React$useState2[0],setOpen=_React$useState2[1];var classes=useStyles();var _React$useState3=React.useState(null),_React$useState4=_slicedToArray(_React$useState3,2),anchorEl=_React$useState4[0],setAnchorEl=_React$useState4[1];// const [response, setResponse] = React.useState( {tags: null, preview: null, carousel: null})\nvar _React$useState5=React.useState({nodes:[],links:[]}),_React$useState6=_slicedToArray(_React$useState5,2),graph=_React$useState6[0],setGraph=_React$useState6[1];var _React$useState7=React.useState([]),_React$useState8=_slicedToArray(_React$useState7,2),imagePreview=_React$useState8[0],setImagePreview=_React$useState8[1];var _React$useState9=React.useState([]),_React$useState10=_slicedToArray(_React$useState9,2),results=_React$useState10[0],setResults=_React$useState10[1];var _React$useState11=React.useState(false),_React$useState12=_slicedToArray(_React$useState11,2),gallery=_React$useState12[0],setGallery=_React$useState12[1];var _React$useState13=React.useState(false),_React$useState14=_slicedToArray(_React$useState13,2),carousel=_React$useState14[0],setCarousel=_React$useState14[1];var showDialog=function showDialog(){setOpen(true);setGallery(!gallery);};var handleClose=function handleClose(){setOpen(false);};var showPopover=function showPopover(event){setAnchorEl(event.currentTarget);};var closePopover=function closePopover(){setAnchorEl(null);};var openPopover=Boolean(anchorEl);function getRandomColor(){var value=Math.random()*0xff|0;var grayscale=value<<16|value<<8|value;var color=\"#\"+grayscale.toString(16);return color;}var onEvents={'mouseMove':showPopover,'click':showDialog};useEffect(function(){function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var tags,preview,randomPreview,images;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"http://127.0.0.1:8000/tags/network\");case 2:tags=_context.sent;setGraph(tags.data);//not sure about the preview call\n_context.next=6;return axios.get(\"http://127.0.0.1:8000/images?tag=\".concat(graph));case 6:preview=_context.sent;randomPreview=preview[Math.floor(Math.random()*preview.length)];setImagePreview(randomPreview);_context.next=11;return axios.get(\"http://127.0.0.1:8000/images?tag=\".concat(graph));case 11:images=_context.sent;setResults(images.data);case 13:case\"end\":return _context.stop();}}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();},[]);var option={tooltip:{alwaysShowContent:true},series:[{type:\"graph\",layout:\"force\",data:graph.nodes.map(function(n){return _objectSpread(_objectSpread({},n),{},{symbolSize:n.value*3,itemStyle:{color:getRandomColor()}});}),links:graph.links.map(function(l){return _objectSpread(_objectSpread({},l),{},{lineStyle:{color:\"#24e1ea\"}});}),roam:true,label:{position:\"right\"},force:{repulsion:100}}]};var showCarousel=function showCarousel(e){setGallery(!gallery);// setSlidePosition(e.target.id);\nsetCarousel(!carousel);};var showGallery=function showGallery(){setCarousel(!carousel);setGallery(!gallery);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"eCharts\",children:/*#__PURE__*/_jsx(ReactEcharts,{style:{width:\"100%\",height:\"100vh\",zIndex:\"auto\"},option:option,onEvents:onEvents})}),/*#__PURE__*/_jsx(\"div\",{className:\"eChartsPreview\",children:/*#__PURE__*/_jsx(Popover,{id:\"mouse-over-popover\",className:classes.popover,classes:{paper:classes.paper},elevation:0,open:openPopover,anchorEl:anchorEl,anchorOrigin:{vertical:'center',horizontal:'center'},transformOrigin:{vertical:'top',horizontal:'right'},onClose:closePopover,disableRestoreFocus:true,children:/*#__PURE__*/_jsx(\"div\",{style:{borderRadius:\"3px\",height:\"110px\",width:\"110px\",boxShadow:\"3px 3px 3px #b4beb7\"},children:/*#__PURE__*/_jsx(\"img\",{src:imagePreview,width:\"110px\",alt:\"\",style:{borderRadius:\"3px\"},onMouseLeave:closePopover})})})}),/*#__PURE__*/_jsx(\"div\",{className:\"eChartsGallery\",children:/*#__PURE__*/_jsxs(Dialog,{onClose:handleClose,\"aria-labelledby\":\"simple-dialog-title\",open:open,maxWidth:\"md\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle//newTitle={newTitle}\n,{id:\"customized-dialog-title\",onClose:handleClose,children:/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",children:[\"Images for `$\",graph.n,\"`\"]})}),/*#__PURE__*/_jsxs(DialogContent,{dividers:true,children:[gallery&&/*#__PURE__*/_jsx(\"div\",{className:\"gallery\",children:/*#__PURE__*/_jsx(\"div\",{className:classes.root,children:/*#__PURE__*/_jsx(ImageList,{rowHeight:160,className:classes.imageList,cols:3,children:results.map(function(item){return/*#__PURE__*/_jsx(ImageListItem,{cols:item.cols||1,children:/*#__PURE__*/_jsx(\"img\",{src:item.id,alt:\"\",maxHeight:\"100px\",onClick:showCarousel})},item.id);})})})}),carousel&&/*#__PURE__*/_jsx(Carousel,{children:results.map(function(item){return/*#__PURE__*/_jsxs(\"div\",{className:\"carouselResults\",children:[/*#__PURE__*/_jsxs(Typography,{className:\"mtag-label\",children:[\" \",item.caption]}),/*#__PURE__*/_jsx(\"div\",{cols:item.cols||1,style:{display:\"flex\",justifyContent:\"center\"},children:/*#__PURE__*/_jsx(\"img\",{id:item.id,src:item.src,alt:\"\",maxHeight:\"100px\",onClick:showGallery})},item.id),/*#__PURE__*/_jsxs(\"div\",{className:\"metadata\",children:[/*#__PURE__*/_jsx(\"div\",{style:{display:\"block\",textAlign:\"center\"},children:/*#__PURE__*/_jsx(Typography,{className:\"mtag-label\",children:\" Our Tags:\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"userTags\",style:{display:\"flex\",justifyContent:\"center\",padding:\"10px\"},children:item.tags.map(function(posttag){return/*#__PURE__*/_jsx(Chip,{className:\"chip1\",style:{color:\"#B272CE\",backgroundColor:\"#FFFFFF\"},avatar:/*#__PURE__*/_jsx(Avatar,{style:{color:\"#B272CE\"},children:/*#__PURE__*/_jsx(\"div\",{style:{color:\"#FFFFFF\"},children:\"#\"})}),label:posttag.tag,component:\"a\",href:\"#chip\",variant:\"outlined\",color:\"primary\",clickable:true},posttag.id);})}),/*#__PURE__*/_jsx(\"div\",{style:{display:\"block\",textAlign:\"center\"},children:/*#__PURE__*/_jsx(Typography,{className:\"ai_tags\",children:\" AI Tags:\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"AITAgs\",style:{display:\"flex\",justifyContent:\"center\",padding:\"10px\"},children:item.ai_tags.map(function(aitag){return/*#__PURE__*/_jsx(Chip,{className:\"chip2\",style:{color:\"#000000\",backgroundColor:\"#FFFFFF\"},avatar:/*#__PURE__*/_jsx(Avatar,{style:{background:\"#B5BCB4\"},children:/*#__PURE__*/_jsx(\"div\",{style:{color:\"#FFFFFF\"},children:\"#\"})}),label:aitag.tag,component:\"a\",href:\"#chip\",clickable:true},aitag.id);})}),/*#__PURE__*/_jsx(\"div\",{children:item.ai_tags.map(function(aiitem){return/*#__PURE__*/_jsx(MatchBar,{match:parseFloat(aiitem.confidence),aitag:aiitem.tag});})})]})]});})})]})]})})]});}","map":{"version":3,"sources":["/Users/jielianglin/Desktop/m-v2-frontend/frontend/src/components/explore/Echarts.js"],"names":["React","useEffect","ReactEcharts","axios","Popover","Dialog","MuiDialogTitle","MuiDialogContent","Typography","Chip","Avatar","IconButton","CloseIcon","withStyles","makeStyles","ImageList","ImageListItem","Carousel","MatchBar","useStyles","theme","popover","pointerEvents","paper","padding","spacing","backgroundColor","root","display","flexWrap","justifyContent","overflow","imageList","width","height","DialogContent","styles","margin","color","closeButton","position","right","top","palette","grey","DialogTitle","props","children","classes","onClose","other","Chart","useState","open","setOpen","anchorEl","setAnchorEl","nodes","links","graph","setGraph","imagePreview","setImagePreview","results","setResults","gallery","setGallery","carousel","setCarousel","showDialog","handleClose","showPopover","event","currentTarget","closePopover","openPopover","Boolean","getRandomColor","value","Math","random","grayscale","toString","onEvents","fetchData","get","tags","data","preview","randomPreview","floor","length","images","option","tooltip","alwaysShowContent","series","type","layout","map","n","symbolSize","itemStyle","l","lineStyle","roam","label","force","repulsion","showCarousel","e","showGallery","zIndex","vertical","horizontal","borderRadius","boxShadow","item","cols","id","caption","src","textAlign","posttag","tag","ai_tags","aitag","background","aiitem","parseFloat","confidence"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\nimport ReactEcharts from \"echarts-for-react\";\nimport axios from \"axios\";\nimport Popover from \"@material-ui/core/Popover\";\nimport Dialog from '@material-ui/core/Dialog';\nimport MuiDialogTitle from \"@material-ui/core/DialogTitle\";\nimport MuiDialogContent from \"@material-ui/core/DialogContent\";\nimport { Typography, Chip, Avatar } from \"@material-ui/core\";\n\nimport IconButton from \"@material-ui/core/IconButton\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport { withStyles } from \"@material-ui/core/styles\";\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport ImageList from '@material-ui/core/ImageList';\nimport ImageListItem from '@material-ui/core/ImageListItem';\n\nimport Carousel from 'react-material-ui-carousel';\n\nimport MatchBar from \"./Matchbar\";\n// import Visual from \"./Visual\";\n\nconst useStyles = makeStyles((theme) => ({\n    popover: {\n        pointerEvents: 'none',\n    },\n    paper: {\n        padding: theme.spacing(1),\n        backgroundColor: 'transparent',\n    },\n    root: {\n        display: 'flex',\n        flexWrap: 'wrap',\n        justifyContent: 'space-around',\n        overflow: 'hidden',\n        backgroundColor: \"#E6DAC8\",\n    },\n    imageList: {\n        width: 500,\n        height: 450,\n    },\n}));\n\nconst DialogContent = withStyles((theme) => ({\n    root: {\n        padding: theme.spacing(2),\n        backgroundColor: \"#E6DAC8\"\n    },\n}))(MuiDialogContent);\n\nconst styles = (theme) => ({\n    root: {\n        margin: 0,\n        padding: theme.spacing(2),\n        color: \"#2B4466\",\n        backgroundColor: \"#E6DAC8\",\n    },\n    closeButton: {\n        position: \"absolute\",\n        right: theme.spacing(1),\n        top: theme.spacing(1),\n        color: theme.palette.grey[500],\n\n    },\n});\n\nconst DialogTitle = withStyles(styles)((props) => {\n    const { children, classes, onClose, ...other } = props;\n    return (\n        <MuiDialogTitle disableTypography className={classes.root} {...other}>\n            <Typography variant=\"h6\">{children}</Typography>\n            {onClose ? (\n                <IconButton\n                    aria-label=\"close\"\n                    className={classes.closeButton}\n                    onClick={onClose}\n                >\n                    <CloseIcon />\n                </IconButton>\n            ) : null}\n        </MuiDialogTitle>\n    );\n});\n\nexport default function Chart() {\n    const [open, setOpen] = React.useState(false);\n    const classes = useStyles();\n    const [anchorEl, setAnchorEl] = React.useState(null);\n    // const [response, setResponse] = React.useState( {tags: null, preview: null, carousel: null})\n    const [graph, setGraph] = React.useState({ nodes: [], links: [] });\n    const [imagePreview, setImagePreview] = React.useState([]);\n    const [results, setResults] = React.useState([]);\n    const [gallery, setGallery] = React.useState(false);\n    const [carousel, setCarousel] = React.useState(false);\n\n    const showDialog = () => {\n        setOpen(true);\n        setGallery(!gallery)\n    }\n\n    const handleClose = () => {\n        setOpen(false);\n\n    };\n    const showPopover = (event) => {\n        setAnchorEl(event.currentTarget);\n    }\n\n    const closePopover = () => {\n        setAnchorEl(null);\n    };\n\n    const openPopover = Boolean(anchorEl);\n\n    function getRandomColor() {\n        var value = (Math.random() * 0xff) | 0;\n        var grayscale = (value << 16) | (value << 8) | value;\n        var color = \"#\" + grayscale.toString(16);\n        return color;\n    }\n\n    const onEvents = {\n        'mouseMove': showPopover,\n        'click': showDialog\n    }\n\n    useEffect(() => {\n        async function fetchData() {\n            const tags = await axios.get(\"http://127.0.0.1:8000/tags/network\");\n            setGraph(tags.data);\n            //not sure about the preview call\n            const preview = await axios.get(`http://127.0.0.1:8000/images?tag=${graph}`);\n            var randomPreview = preview[Math.floor(Math.random() * preview.length)];\n            setImagePreview(randomPreview);\n            const images = await axios.get(`http://127.0.0.1:8000/images?tag=${graph}`)\n            setResults(images.data);\n        }\n        fetchData();\n    }, []);\n\n    let option = {\n        tooltip: {\n            alwaysShowContent: true,\n        },\n        series: [\n            {\n                type: \"graph\",\n                layout: \"force\",\n                data: graph.nodes.map((n) => ({\n                    ...n,\n                    symbolSize: n.value * 3,\n                    itemStyle: { color: getRandomColor() },\n                })),\n                links: graph.links.map((l) => ({\n                    ...l,\n                    lineStyle: { color: \"#24e1ea\" },\n                })),\n                roam: true,\n                label: {\n                    position: \"right\",\n                },\n                force: {\n                    repulsion: 100,\n                },\n            },\n        ],\n    };\n    const showCarousel = (e) => {\n        setGallery(!gallery);\n        // setSlidePosition(e.target.id);\n        setCarousel(!carousel);\n    }\n    const showGallery = () => {\n        setCarousel(!carousel);\n        setGallery(!gallery);\n    }\n\n    return (\n        <div>\n\n            <div className=\"eCharts\">\n                <ReactEcharts style={{ width: \"100%\", height: \"100vh\", zIndex: \"auto\" }} option={option} onEvents={onEvents} />\n            </div>\n            {/* <div> <Visual style={{ position: \"absolute\", zIndex: -1 }} /> </div> */}\n            <div className=\"eChartsPreview\">\n                <Popover\n                    id=\"mouse-over-popover\"\n                    className={classes.popover}\n                    classes={{\n                        paper: classes.paper,\n                    }}\n                    elevation={0}\n                    open={openPopover}\n                    anchorEl={anchorEl}\n                    anchorOrigin={{\n                        vertical: 'center',\n                        horizontal: 'center',\n                    }}\n                    transformOrigin={{\n                        vertical: 'top',\n                        horizontal: 'right',\n                    }}\n                    onClose={closePopover}\n                    disableRestoreFocus\n                >\n                    <div\n                        style={{\n                            borderRadius: \"3px\",\n                            height: \"110px\",\n                            width: \"110px\",\n                            boxShadow: \"3px 3px 3px #b4beb7\"\n                        }}\n                    >\n                        <img src={imagePreview}\n                            width=\"110px\" alt=\"\"\n                            style={{\n                                borderRadius: \"3px\",\n                            }}\n                            onMouseLeave={closePopover}\n                        />\n                    </div>\n                </Popover>\n            </div>\n            <div className=\"eChartsGallery\">\n                <Dialog\n                    onClose={handleClose}\n                    aria-labelledby=\"simple-dialog-title\"\n                    open={open}\n                    maxWidth=\"md\"\n                    fullWidth={true}\n                >\n                    <DialogTitle\n                        //newTitle={newTitle}\n                        id=\"customized-dialog-title\"\n                        onClose={handleClose}\n                    >\n                        <Typography variant=\"h5\">Images for `${graph.n}`</Typography>\n                    </DialogTitle>\n                    <DialogContent dividers>\n                        {gallery && (\n                            <div className=\"gallery\">\n                                <div className={classes.root}>\n                                    <ImageList rowHeight={160} className={classes.imageList} cols={3}>\n                                        {results.map((item) => (\n                                            <ImageListItem key={item.id} cols={item.cols || 1} >\n                                                <img src={item.id} alt=\"\" maxHeight=\"100px\"\n                                                    onClick={showCarousel}\n                                                />\n                                            </ImageListItem>\n                                        ))}\n                                    </ImageList>\n                                </div>\n                            </div>\n                        )}\n                        {carousel && (\n                            <Carousel>\n                                {results.map((item) => (\n                                    <div className=\"carouselResults\">\n                                        <Typography className=\"mtag-label\"> {item.caption}\n                                        </Typography>\n                                        <div key={item.id} cols={item.cols || 1} style={{ display: \"flex\", justifyContent: \"center\" }}>\n                                            <img id={item.id} src={item.src} alt=\"\" maxHeight=\"100px\" onClick={showGallery}\n                                            />\n                                        </div>\n\n                                        <div className=\"metadata\" >\n                                            <div style={{ display: \"block\", textAlign: \"center\" }}>\n                                                <Typography className=\"mtag-label\"> Our Tags:\n                                                </Typography>\n                                            </div>\n                                            <div className=\"userTags\" style={{ display: \"flex\", justifyContent: \"center\", padding: \"10px\" }}>\n\n                                                {item.tags.map((posttag) => {\n\n                                                    return (\n                                                        <Chip className=\"chip1\" style={{ color: \"#B272CE\", backgroundColor: \"#FFFFFF\" }} avatar={\n                                                            <Avatar style={{ color: \"#B272CE\" }}>\n                                                                <div style={{ color: \"#FFFFFF\" }}>\n                                                                    #\n                                                                </div>\n                                                            </Avatar>\n                                                        }\n                                                            key={posttag.id}\n                                                            label={posttag.tag}\n                                                            component=\"a\"\n                                                            href=\"#chip\"\n                                                            variant=\"outlined\"\n                                                            color=\"primary\"\n                                                            clickable\n                                                        />\n                                                    );\n                                                })}\n                                            </div>\n\n                                            <div style={{ display: \"block\", textAlign: \"center\" }}>\n                                                <Typography className=\"ai_tags\"> AI Tags:\n                                                </Typography>\n                                            </div>\n                                            <div className=\"AITAgs\" style={{ display: \"flex\", justifyContent: \"center\", padding: \"10px\" }}>\n\n\n                                                {item.ai_tags.map((aitag) => {\n\n                                                    return (\n                                                        <Chip className=\"chip2\" style={{ color: \"#000000\", backgroundColor: \"#FFFFFF\" }} avatar={\n                                                            <Avatar style={{ background: \"#B5BCB4\" }}>\n                                                                <div style={{ color: \"#FFFFFF\" }}>\n                                                                    #\n                                                                </div>\n                                                            </Avatar>\n                                                        }\n                                                            key={aitag.id}\n                                                            label={aitag.tag}\n                                                            component=\"a\"\n                                                            href=\"#chip\"\n                                                            clickable\n                                                        />\n                                                    );\n                                                })}\n                                            </div>\n                                            <div>\n                                                {item.ai_tags.map((aiitem) => {\n                                                    return (\n                                                        <MatchBar\n                                                            match={parseFloat(aiitem.confidence)}\n                                                            aitag={aiitem.tag}\n                                                        />\n                                                    );\n                                                })}\n                                            </div>\n                                        </div>\n                                    </div>))}\n                            </Carousel>\n                        )\n                        }\n                    </DialogContent>\n                </Dialog>\n            </div>\n        </div>);\n}\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"var _jsxFileName = \"/Users/jielianglin/Desktop/m-v2-frontend/frontend/src/components/upload/annotation/P5Lasso.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport axios from \"axios\";\nimport FileInput from '../FileInput';\nimport Tags from './Tags';\nimport Caption from './Caption';\nimport Sketch from 'react-p5';\nimport ColorSelector from './ColorSelector';\nimport EraserIcon from './eraser/EraserIcon.png';\nimport CheckMark from './checkmark/CheckMark.png';\nimport { Typography, Chip, Avatar } from \"@material-ui/core\";\nimport Button from \"@material-ui/core/Button\";\nimport VisibilitySharpIcon from '@material-ui/icons/VisibilitySharp';\nimport VisibilityOffIcon from '@material-ui/icons/VisibilityOff';\nimport { ThemeProvider } from \"@material-ui/styles\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { createTheme } from \"@material-ui/core/styles\";\nimport MatchBar from \"../../explore/Matchbar\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar checkButton;\nvar cnv;\nvar smoothValue = 0.05;\nvar init;\nvar x = 0;\nvar y = 0;\nvar path = [];\nvar currentPath = [];\nvar img;\nvar pg;\nvar clearButton;\nvar imgWidth;\nvar imgHeight;\nconst theme = createTheme({\n  palette: {\n    primary: {\n      main: \"#B272CE\"\n    }\n  }\n});\nexport default function P5Lasso() {\n  _s();\n\n  const [color, setColor] = React.useState([\"#B272CE\"]);\n  const [canvasImage, setCanvasImage] = React.useState(null);\n  const [post, setPost] = React.useState(false);\n  const [tags, setTags] = React.useState([]);\n  const [src, setSrc] = React.useState(null);\n  const [caption, setCaption] = React.useState(null);\n  const [returnCaption, setReturnCaption] = React.useState(null);\n  const [returnTags, setReturnTags] = React.useState([]);\n  const [returnAITags, setReturnAITags] = React.useState([]);\n  const [returnShape, setReturnShape] = React.useState([]);\n  const [shapeVisibility, setShapeVisibility] = React.useState(false);\n  const [progress, setProgress] = React.useState(false);\n\n  const enteredCaption = caption => {\n    setCaption(caption);\n  };\n\n  const selectedTags = tags => {\n    setTags(tags);\n  }; // const selectedImage = (img) => {\n  //   setImage(img);\n  //   setCanvasImage(img);\n  //   console.log(\"setImage\");\n  // };\n\n\n  const resetCanvas = () => {\n    setCanvasImage(!canvasImage);\n  };\n\n  function setup(p5, canvasParentRef) {\n    cnv = p5.createCanvas(600, 600).parent(canvasParentRef);\n    pg = p5.createGraphics(600, 600);\n    p5.background('black');\n    img = p5.loadImage(canvasImage, img => {\n      p5.image(img, 0, 0);\n      console.log(\"canvasImage\");\n    });\n    checkButton = p5.createImg(`${CheckMark}`).style('margin: 10px; width: 50px; height: 50px');\n    checkButton.position(100, 200);\n    checkButton.mousePressed(setFiles);\n    clearButton = p5.createImg(`${EraserIcon}`).style('margin: 10px; width: 50px; height: 50px');\n    clearButton.position(100, 300);\n    clearButton.mousePressed(resetSketch);\n  }\n\n  function draw(p5) {\n    x = p5.lerp(x, p5.mouseX, smoothValue);\n    y = p5.lerp(y, p5.mouseY, smoothValue);\n    imgWidth = img.width;\n    imgHeight = img.height;\n\n    if (imgWidth > 0 && imgHeight > 0) {\n      p5.resizeCanvas(imgWidth, imgHeight);\n\n      if (imgWidth > 700) {\n        p5.resizeCanvas(700, 700);\n      }\n    }\n\n    p5.image(img, 0, 0);\n\n    if (p5.mouseIsPressed) {\n      pg.fill(color);\n      pg.stroke(color);\n      pg.strokeWeight(1);\n      pg.ellipse(x, y, 15, 15);\n      currentPath.push([x, y]);\n      init = currentPath[0];\n    }\n\n    p5.image(pg, 0, 0, imgWidth, imgHeight);\n  }\n\n  function mouseReleased(p5) {\n    if (canvasImage) {\n      pg.strokeWeight(15);\n      pg.line(x, y, ...init);\n      currentPath = [];\n      path.push(currentPath);\n    }\n  }\n\n  function resetSketch(p5) {\n    pg.clear();\n  } //preparing files for post\n\n\n  function setFiles(p5) {\n    let image = cnv.elt.toDataURL();\n    let shape = pg.elt.toDataURL();\n    return {\n      image,\n      shape\n    };\n  }\n\n  let APIurl = \"http://localhost:8000/images\"; // main post function\n\n  async function postData(p5) {\n    let {\n      image,\n      shape\n    } = setFiles(p5);\n    let formData = new FormData();\n    console.log(tags.join(\",\"));\n    formData.append(\"tags\", tags.join(\",\"));\n    formData.append(\"caption\", caption);\n    formData.append(\"files\", [image, shape]);\n    let response = {};\n\n    try {\n      response = await axios.post(APIurl, formData);\n    } catch (e) {\n      console.error(e);\n      return;\n    }\n\n    setSrc(`http://localhost:8000/images/${response.data.id}.jpeg`);\n    console.log(response.data.caption);\n    setReturnCaption(response.data.caption);\n    console.log(response.data.tags);\n    setReturnTags(response.data.tags);\n    console.log(response.data.ai_tags);\n    setReturnAITags(response.data.ai_tags || []);\n    setReturnShape(`http://localhost:8000/images/${response.data.shape}.png`);\n    setPost(true);\n    setProgress(false);\n  }\n\n  const showShape = () => {\n    setShapeVisibility(!shapeVisibility);\n  };\n\n  if (canvasImage) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          backgroundColor: \"#FFFFFF\",\n          borderRadius: \"3px\",\n          boxShadow: \"3px 3px 3px #b4beb7\",\n          padding: \"50px\",\n          maxWidth: \"800px\",\n          height: \"auto\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(Caption, {\n          enteredCaption: enteredCaption\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Sketch, {\n            setup: setup,\n            draw: draw,\n            mouseReleased: mouseReleased,\n            resetSketch: resetSketch,\n            setFiles: setFiles\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Tags, {\n          selectedTags: selectedTags\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ColorSelector, {\n        selectColor: color => setColor(color)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"save-data\",\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          disabled: !canvasImage || !caption || tags.length === 0,\n          className: \"save-button\",\n          palette: \"primary\",\n          onClick: postData,\n          children: [\" \", \"Save\", \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ThemeProvider, {\n          theme: theme,\n          children: progress && /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 9\n      }, this), post ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"returnForm\",\n        style: {\n          backgroundColor: \"#FFFFFF\",\n          borderRadius: \"3px\",\n          boxShadow: \"3px 3px 3px #b4beb7\",\n          padding: \"50px\",\n          maxWidth: \"800px\",\n          height: \"auto\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          style: {\n            display: \"block\",\n            margin: \"0 auto\",\n            height: \"50%\",\n            borderRadius: \"5px\",\n            zIndex: 1\n          },\n          className: \"returned-image\",\n          src: src,\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 15\n        }, this), shapeVisibility && /*#__PURE__*/_jsxDEV(\"img\", {\n          style: {\n            display: \"block\",\n            margin: \"0 auto\",\n            height: \"50%\",\n            borderRadius: \"5px\",\n            zIndex: 2\n          },\n          className: \"returned-shape\",\n          src: returnShape,\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: showShape,\n          children: shapeVisibility ? /*#__PURE__*/_jsxDEV(VisibilityOffIcon, {\n            fontsize: \"medium\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 36\n          }, this) : /*#__PURE__*/_jsxDEV(VisibilitySharpIcon, {\n            fontsize: \"medium\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 78\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(ThemeProvider, {\n          theme: theme,\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"h6\",\n            color: \"primary\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"returned-caption\",\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                children: \"\\\"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 267,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"i\", {\n                children: [\" \", /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: returnCaption\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 270,\n                  columnNumber: 23\n                }, this), \" \"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"i\", {\n                children: \"\\\"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 272,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tags-return\",\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              color: \"primary\",\n              children: \" Your Tags: \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 19\n            }, this), returnTags.map(item => /*#__PURE__*/_jsxDEV(Chip, {\n              className: \"chip1\",\n              style: {\n                color: \"#B272CE\",\n                backgroundColor: \"#FFFFFF\"\n              },\n              avatar: /*#__PURE__*/_jsxDEV(Avatar, {\n                style: {\n                  color: \"#B272CE\"\n                },\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    color: \"#FFFFFF\"\n                  },\n                  children: \"#\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 281,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 280,\n                columnNumber: 23\n              }, this),\n              label: item.tag,\n              variant: \"outlined\"\n            }, item.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 279,\n              columnNumber: 21\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"ai_tags_return\",\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              color: \"secondary\",\n              children: \" Tags from ImageNet AI: \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 19\n            }, this), returnAITags.length === 0 && /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"h12\",\n              color: \"#000000\",\n              children: /*#__PURE__*/_jsxDEV(\"i\", {\n                children: \"[couldn't identify any tags] \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 298,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 21\n            }, this), returnAITags.map(item => /*#__PURE__*/_jsxDEV(Chip, {\n              className: \"chip2\",\n              style: {\n                color: \"#000000\",\n                backgroundColor: \"#FFFFFF\"\n              },\n              avatar: /*#__PURE__*/_jsxDEV(Avatar, {\n                style: {\n                  background: \"#B5BCB4\"\n                },\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    color: \"#FFFFFF\"\n                  },\n                  children: \"#\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 306,\n                  columnNumber: 27\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 305,\n                columnNumber: 25\n              }, this),\n              label: item.tag\n            }, item.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 303,\n              columnNumber: 21\n            }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: returnAITags.map(aiitem => {\n                return /*#__PURE__*/_jsxDEV(MatchBar, {\n                  match: parseFloat(aiitem.confidence),\n                  aitag: aiitem.tag\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 319,\n                  columnNumber: 25\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 327,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            onClick: resetCanvas,\n            children: \"Back to Well-Being upload\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 328,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 329,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 13\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 7\n    }, this);\n  } else {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(FileInput, {\n        selectImage: setCanvasImage // selectedImage={selectedImage}\n\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 7\n    }, this);\n  }\n}\n\n_s(P5Lasso, \"031FSyuGS/jtIjbI/TxtUrJlNog=\");\n\n_c = P5Lasso;\n\nvar _c;\n\n$RefreshReg$(_c, \"P5Lasso\");","map":{"version":3,"sources":["/Users/jielianglin/Desktop/m-v2-frontend/frontend/src/components/upload/annotation/P5Lasso.js"],"names":["React","axios","FileInput","Tags","Caption","Sketch","ColorSelector","EraserIcon","CheckMark","Typography","Chip","Avatar","Button","VisibilitySharpIcon","VisibilityOffIcon","ThemeProvider","CircularProgress","createTheme","MatchBar","checkButton","cnv","smoothValue","init","x","y","path","currentPath","img","pg","clearButton","imgWidth","imgHeight","theme","palette","primary","main","P5Lasso","color","setColor","useState","canvasImage","setCanvasImage","post","setPost","tags","setTags","src","setSrc","caption","setCaption","returnCaption","setReturnCaption","returnTags","setReturnTags","returnAITags","setReturnAITags","returnShape","setReturnShape","shapeVisibility","setShapeVisibility","progress","setProgress","enteredCaption","selectedTags","resetCanvas","setup","p5","canvasParentRef","createCanvas","parent","createGraphics","background","loadImage","image","console","log","createImg","style","position","mousePressed","setFiles","resetSketch","draw","lerp","mouseX","mouseY","width","height","resizeCanvas","mouseIsPressed","fill","stroke","strokeWeight","ellipse","push","mouseReleased","line","clear","elt","toDataURL","shape","APIurl","postData","formData","FormData","join","append","response","e","error","data","id","ai_tags","showShape","backgroundColor","borderRadius","boxShadow","padding","maxWidth","length","display","margin","zIndex","map","item","tag","aiitem","parseFloat","confidence"],"mappings":"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","sourcesContent":["import React from 'react';\nimport axios from \"axios\";\n\nimport FileInput from '../FileInput';\nimport Tags from './Tags';\nimport Caption from './Caption';\n\nimport Sketch from 'react-p5';\nimport ColorSelector from './ColorSelector';\n\nimport EraserIcon from './eraser/EraserIcon.png';\nimport CheckMark from './checkmark/CheckMark.png';\n\nimport { Typography, Chip, Avatar } from \"@material-ui/core\";\nimport Button from \"@material-ui/core/Button\";\nimport VisibilitySharpIcon from '@material-ui/icons/VisibilitySharp';\nimport VisibilityOffIcon from '@material-ui/icons/VisibilityOff';\n\nimport { ThemeProvider } from \"@material-ui/styles\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { createTheme } from \"@material-ui/core/styles\";\n\nimport MatchBar from \"../../explore/Matchbar\";\n\nvar checkButton;\nvar cnv;\nvar smoothValue = 0.05;\nvar init;\nvar x = 0;\nvar y = 0;\nvar path = [];\nvar currentPath = [];\nvar img;\nvar pg;\nvar clearButton;\nvar imgWidth;\nvar imgHeight;\n\nconst theme = createTheme({\n  palette: {\n    primary: {\n      main: \"#B272CE\",\n    },\n  },\n});\n\nexport default function P5Lasso() {\n  const [color, setColor] = React.useState([\"#B272CE\"]);\n  const [canvasImage, setCanvasImage] = React.useState(null);\n\n  const [post, setPost] = React.useState(false);\n  const [tags, setTags] = React.useState([]);\n  const [src, setSrc] = React.useState(null);\n  const [caption, setCaption] = React.useState(null);\n  const [returnCaption, setReturnCaption] = React.useState(null);\n  const [returnTags, setReturnTags] = React.useState([])\n  const [returnAITags, setReturnAITags] = React.useState([]);\n  const [returnShape, setReturnShape] = React.useState([]);\n  const [shapeVisibility, setShapeVisibility] = React.useState(false);\n  const [progress, setProgress] = React.useState(false);\n\n  const enteredCaption = (caption) => {\n    setCaption(caption);\n  };\n  const selectedTags = (tags) => {\n    setTags(tags);\n  };\n\n  // const selectedImage = (img) => {\n  //   setImage(img);\n  //   setCanvasImage(img);\n  //   console.log(\"setImage\");\n  // };\n\n  const resetCanvas = () => {\n    setCanvasImage(!canvasImage);\n  }\n\n  function setup(p5, canvasParentRef) {\n    cnv = p5.createCanvas(600, 600).parent(canvasParentRef);\n    pg = p5.createGraphics(600, 600);\n    p5.background('black');\n    img = p5.loadImage(canvasImage, img => {\n      p5.image(img, 0, 0);\n      console.log(\"canvasImage\");\n    });\n\n    checkButton = p5.createImg(`${CheckMark}`).style(\n      'margin: 10px; width: 50px; height: 50px'\n    )\n\n    checkButton.position(100, 200);\n    checkButton.mousePressed(setFiles);\n\n    clearButton = p5.createImg(`${EraserIcon}`).style(\n      'margin: 10px; width: 50px; height: 50px'\n    )\n    clearButton.position(100, 300);\n    clearButton.mousePressed(resetSketch);\n  }\n\n  function draw(p5) {\n    x = p5.lerp(x, p5.mouseX, smoothValue);\n    y = p5.lerp(y, p5.mouseY, smoothValue);\n\n    imgWidth = img.width;\n    imgHeight = img.height;\n\n    if (imgWidth > 0 && imgHeight > 0) {\n      p5.resizeCanvas(imgWidth, imgHeight);\n      if (imgWidth > 700) {\n        p5.resizeCanvas(700, 700);\n      }\n    }\n\n    p5.image(img, 0, 0);\n\n    if (p5.mouseIsPressed) {\n      pg.fill(color);\n      pg.stroke(color);\n      pg.strokeWeight(1);\n      pg.ellipse(x, y, 15, 15);\n      currentPath.push([x, y]);\n      init = currentPath[0];\n    }\n    p5.image(pg, 0, 0, imgWidth, imgHeight);\n  }\n\n  function mouseReleased(p5) {\n    if (canvasImage) {\n      pg.strokeWeight(15);\n      pg.line(x, y, ...init);\n      currentPath = [];\n      path.push(currentPath);\n    }\n  }\n\n  function resetSketch(p5) {\n    pg.clear();\n  }\n\n  //preparing files for post\n  function setFiles(p5) {\n    let image = cnv.elt.toDataURL();\n    let shape = pg.elt.toDataURL();\n    return { image, shape };\n  }\n\n  let APIurl = \"http://localhost:8000/images\";\n\n  // main post function\n  async function postData(p5) {\n    let { image, shape } = setFiles(p5);\n\n    let formData = new FormData();\n    console.log(tags.join(\",\"));\n    formData.append(\"tags\", tags.join(\",\"));\n    formData.append(\"caption\", caption);\n    formData.append(\"files\", [image, shape]);\n\n    let response = {};\n    try {\n      response = await axios.post(APIurl, formData);\n    } catch (e) {\n      console.error(e);\n      return;\n    }\n\n    setSrc(`http://localhost:8000/images/${response.data.id}.jpeg`);\n    console.log(response.data.caption);\n    setReturnCaption(response.data.caption);\n    console.log(response.data.tags);\n    setReturnTags(response.data.tags);\n    console.log(response.data.ai_tags);\n    setReturnAITags(response.data.ai_tags || []);\n    setReturnShape(`http://localhost:8000/images/${response.data.shape}.png`);\n    setPost(true);\n    setProgress(false);\n  }\n\n  const showShape = () => {\n    setShapeVisibility(!shapeVisibility);\n  }\n\n  if (canvasImage) {\n    return (\n      <div>\n        <br />\n        <div style={{ backgroundColor: \"#FFFFFF\", borderRadius: \"3px\", boxShadow: \"3px 3px 3px #b4beb7\", padding: \"50px\", maxWidth: \"800px\", height: \"auto\" }}>\n          <Caption enteredCaption={enteredCaption} />\n          <div>\n            <br />\n            <Sketch\n              setup={setup}\n              draw={draw}\n              mouseReleased={mouseReleased}\n              resetSketch={resetSketch}\n              setFiles={setFiles}\n            />\n          </div>\n          <br />\n          <Tags selectedTags={selectedTags} />\n        </div>\n        <ColorSelector selectColor={color => setColor(color)} />\n        <div className=\"save-data\">\n          <Button\n            disabled={!canvasImage || !caption || tags.length === 0}\n            className=\"save-button\"\n            palette=\"primary\"\n            onClick={postData}\n          >\n            {\" \"}\n            Save{\" \"}\n          </Button>\n          <ThemeProvider theme={theme}>\n            {progress &&\n              <CircularProgress />}\n          </ThemeProvider>\n        </div>\n\n\n        {\n          post ?\n            <div className=\"returnForm\" style={{\n              backgroundColor: \"#FFFFFF\",\n              borderRadius: \"3px\",\n              boxShadow: \"3px 3px 3px #b4beb7\",\n              padding: \"50px\",\n              maxWidth: \"800px\",\n              height: \"auto\"\n            }}>\n              < img\n                style={{\n                  display: \"block\",\n                  margin: \"0 auto\",\n                  height: \"50%\",\n                  borderRadius: \"5px\",\n                  zIndex: 1,\n                }}\n                className=\"returned-image\"\n                src={src}\n                alt=\"\"\n              />\n              {shapeVisibility &&\n                <img\n                  style={{\n                    display: \"block\",\n                    margin: \"0 auto\",\n                    height: \"50%\",\n                    borderRadius: \"5px\",\n                    zIndex: 2,\n                  }}\n                  className=\"returned-shape\"\n                  src={returnShape}\n                  alt=\"\"\n                />\n              }\n\n              <br />\n              <Button onClick={showShape}>\n                {shapeVisibility ? <VisibilityOffIcon fontsize=\"medium\" /> : <VisibilitySharpIcon fontsize=\"medium\" />}\n              </Button>\n              <br />\n              <ThemeProvider theme={theme}>\n                <Typography variant=\"h6\" color=\"primary\">\n                  <div className=\"returned-caption\">\n                    <i>\"</i>\n                    <i>\n                      {\" \"}\n                      <span>{returnCaption}</span>{\" \"}\n                    </i>\n                    <i>\"</i>\n                  </div>\n                </Typography>\n                <br />\n                <span className=\"tags-return\">\n                  <Typography color=\"primary\"> Your Tags: </Typography>\n                  {returnTags.map((item) => (\n                    <Chip className=\"chip1\" style={{ color: \"#B272CE\", backgroundColor: \"#FFFFFF\" }} avatar={\n                      <Avatar style={{ color: \"#B272CE\" }}>\n                        <div style={{ color: \"#FFFFFF\" }}>\n                          #\n                        </div>\n                      </Avatar>\n                    }\n                      key={item.id}\n                      label={item.tag}\n                      variant=\"outlined\"\n                    />\n                  ))}\n                </span>\n                <br />\n                <br />\n                <span className=\"ai_tags_return\">\n                  <Typography color=\"secondary\"> Tags from ImageNet AI: </Typography>\n                  {returnAITags.length === 0 && (\n                    <Typography variant=\"h12\" color=\"#000000\">\n                      <i>[couldn't identify any tags] </i>\n                    </Typography>\n                  )}\n\n                  {returnAITags.map((item) => (\n                    <Chip className=\"chip2\" style={{ color: \"#000000\", backgroundColor: \"#FFFFFF\" }}\n                      avatar={\n                        <Avatar style={{ background: \"#B5BCB4\" }}>\n                          <div style={{ color: \"#FFFFFF\" }}>\n                            #\n                          </div>\n                        </Avatar>\n                      }\n                      key={item.id}\n                      label={item.tag}\n                    />\n                  ))}\n\n                  <div>\n                    {returnAITags.map((aiitem) => {\n                      return (\n                        <MatchBar\n                          match={parseFloat(aiitem.confidence)}\n                          aitag={aiitem.tag}\n                        />\n                      );\n                    })}\n                  </div>\n                </span>\n                <br />\n                <Button onClick={resetCanvas}>Back to Well-Being upload</Button>\n                <br />\n              </ThemeProvider>\n            </div >\n            : null\n        }\n      </div>)\n  } else {\n    return (\n      <div>\n        <FileInput\n          selectImage={setCanvasImage}\n        // selectedImage={selectedImage}\n        />\n      </div>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}